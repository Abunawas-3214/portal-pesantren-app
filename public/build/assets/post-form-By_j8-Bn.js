import{R as v,W as N,r as w,j as e,a as _}from"./app-DyBQa7Co.js";import{T as k}from"./Tiptap-BHJCrrNc.js";import{I as o}from"./InputError-CcR4kwww.js";import{s as C}from"./slugify-D2QUhzfV.js";import{L as S}from"./loader-DYG1iVdg.js";function T({postData:s,categories:x}){const[a,h]=v.useState((s==null?void 0:s.featured_image)||null),u=s==null?void 0:s.categories.map(r=>r.id),{data:d,setData:l,post:g,put:P,errors:i,reset:I,processing:n}=N({title:(s==null?void 0:s.title)||"",slug:(s==null?void 0:s.slug)||"",categories:u||[],content:(s==null?void 0:s.content)||"",featured_image:(s==null?void 0:s.featured_image)||void 0,status:(s==null?void 0:s.status)||"published",_method:s&&"PUT"});w.useEffect(()=>{const r=C(d.title,{lower:!0,strict:!0});l("slug",r)},[d.title]);const b=r=>{const t=Array.from(r.target.selectedOptions,m=>m.value);l("categories",t)},j=r=>{var f;const t=(f=r.target.files)==null?void 0:f[0];l("featured_image",t);const m=[];if(t){const c=new FileReader;c.readAsDataURL(t),m.push(new Promise((y,$)=>{c.onload=()=>y(c.result)}))}Promise.all(m).then(c=>{h(c[0])})},p=r=>{r.preventDefault(),s?(d.featured_image===s.featured_image&&delete d.featured_image,g(route("post.update",s.id))):(delete d._method,g(route("post.store")))};return e.jsxs("form",{className:"space-y-6",onSubmit:p,children:[e.jsxs("div",{className:"grid w-full grid-cols-7 gap-8 h-fit",children:[e.jsxs("div",{className:"w-full h-full col-span-5 space-y-6",children:[e.jsxs("div",{className:"w-full space-y-2",children:[e.jsx("input",{disabled:n,value:d.title,onChange:r=>l("title",r.target.value),type:"text",placeholder:"Tulis Judul Post di Sini",className:`block w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-xl sm:font-bold ${i.title?"border-red-300 text-red-900 focus:ring-red-500 focus:border-red-500":""}`}),e.jsx(o,{message:i.title})]}),e.jsx(k,{content:(s==null?void 0:s.content)||"",onChange:r=>l("content",r)}),e.jsx(o,{message:i.content})]}),e.jsxs("div",{className:"col-span-2 space-y-6",children:[e.jsxs("div",{className:"",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Slug ",e.jsx("span",{className:"text-xs text-gray-400",children:"(tergenerate secara otomatis)"})]}),e.jsx("input",{disabled:n,value:d.slug,onChange:r=>l("slug",r.target.value),type:"text",id:"slug",className:`block w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm ${i.slug?"border-red-300 text-red-900 focus:ring-red-500 focus:border-red-500":""}`}),e.jsx(o,{message:i.slug})]}),e.jsxs("div",{className:"",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Kategori"}),e.jsx("select",{defaultValue:u==null?void 0:u.map(r=>r.toString()),onChange:b,id:"permissions",name:"permissions",multiple:!0,className:`block w-full h-28 px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm ${i.categories?"border-red-300 text-red-900 focus:ring-red-500 focus:border-red-500":""}`,children:x.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))}),e.jsx(o,{message:i.categories})]}),e.jsxs("div",{className:"",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Featured Image"}),e.jsx("div",{className:"",children:a&&e.jsx("div",{className:"flex items-center justify-center w-full mt-2 border border-gray-300 rounded-md shadow-sm h-fit",children:e.jsx("img",{src:a,alt:"Uploaded Image",className:"object-cover w-full h-full"})})}),e.jsx("input",{disabled:n,onChange:j,type:"file",accept:"image/*",className:`block w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm ${i.featured_image?"border-red-300 text-red-900 focus:ring-red-500 focus:border-red-500":""}`}),e.jsx(o,{message:i.featured_image})]}),e.jsxs("div",{className:"",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{onChange:r=>l("status",r.target.value),value:d.status,className:"block w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"published",children:"Published"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"archived",children:"Archived"})]}),e.jsx(o,{message:i.status})]})]})]}),e.jsxs("div",{className:"px-4 py-3 text-right sm:px-6",children:[e.jsx("button",{children:e.jsx(_,{disabled:n,href:route("post.index"),className:`inline-flex items-center px-4 py-2 mr-4 text-sm font-medium text-indigo-700 bg-indigo-100 border border-transparent rounded-md hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 ${n?"opacity-25 cursor-not-allowed":""}`,children:"Cancel"})}),e.jsx("button",{disabled:n,type:"submit",className:`inline-flex justify-center px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 items-center ${n?"opacity-25 cursor-not-allowed":""}`,children:n?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-3 h-3 mr-2 animate-spin"})," Loading..."]}):s?"Update":"Save"})]})]})}export{T as P};
